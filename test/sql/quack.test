# name: test/sql/quack.test
# description: test dns_query extension
# group: [sql]

# Before we load the extension, this will fail
statement error
SELECT dns_cname_lookup('flights.google.com');
----
Catalog Error: Scalar Function with name dns_cname_lookup does not exist!

# Require statement will ensure this test is run with this extension loaded
require dns_query

# Test CNAME record lookup for flights.google.com with real DNS
query I
SELECT dns_cname_lookup('flights.google.com') as cname;
----
www3.l.google.com

# Top level domains don't support CNAME so test it returns empty string
query I
SELECT dns_cname_lookup('google.com');
----
(empty)

# Test that invalid domain returns empty string
query I
SELECT dns_cname_lookup('this-domain-definitely-does-not-exist-12345.com');
----
(empty)
